#!/bin/bash
notify-send -t 1000 "Please drag your mouse over the screenshot selection"
pkill escrotum
#scrot -s "/tmp/mostrecentscrot.png"  #|  tr -s '[[:punct:][:space:]]' '\n' |  sed -n 's/[^0-9]*//p' | xargs -n1 notify-send -u normal
escrotum -s --selection-delay=500 /tmp/mostrecentscrot.png  # 300 milliseconds to ensure no gray or border on screenshot
NEW_NAME=$(rofi -dpi 1 -dmenu -i -p "Set File Name")
if [[ $NEW_NAME != *.png ]] 
then
    NEW_NAME="$NEW_NAME.png"
fi
SHOT_DIR=$HOME/media/photos/screenshots/$(ls ~/media/photos/screenshots | grep -v "\." | rofi -dpi 1 -dmenu -i -p "Select Dir to save to") 
if  [ ! -d "$SHOT_DIR" ]
then
   mkdir "$SHOT_DIR"
fi
FILE_LOCATION=$SHOT_DIR/$NEW_NAME
mv /tmp/mostrecentscrot.png "$FILE_LOCATION"
# Allow us to mark the file if the screenshot didn't come out right and delete it upon sxiv exit
sxiv -o "$FILE_LOCATION" | xargs -I{} rm {}
if [[ -e $FILE_LOCATION ]]
then
    xclip -selection clipboard -t image/png -i "$FILE_LOCATION"
fi
